(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     13651,        383]
NotebookOptionsPosition[     13007,        366]
NotebookOutlinePosition[     13410,        382]
CellTagsIndexPosition[     13367,        379]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"contourgrad", "[", 
   RowBox[{"f_", ",", 
    RowBox[{"box_", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "2"}], "}"}]}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xmin", "=", 
         RowBox[{"box", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"xmax", "=", 
         RowBox[{"box", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
        RowBox[{"ymin", "=", 
         RowBox[{"box", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"ymax", "=", 
         RowBox[{"box", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", 
        RowBox[{"a", "=", 
         RowBox[{"pt", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"b", "=", 
         RowBox[{"pt", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", "plt", ",", "grad", ",", 
        "gv"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"grad", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"x", ",", "y"}], "]"}], ",", "x"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"x", ",", "y"}], "]"}], ",", "y"}], "]"}]}], "}"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "\[Rule]", 
            RowBox[{"pt", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"y", "\[Rule]", 
            RowBox[{"pt", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"gv", "=", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{"Red", ",", "Thick", ",", 
           RowBox[{"PointSize", "[", "Large", "]"}], ",", 
           RowBox[{"Point", "[", "pt", "]"}], ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{"pt", ",", 
              RowBox[{"pt", "+", "grad"}]}], "}"}], "]"}]}], "}"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"plt", "=", 
        RowBox[{"ContourPlot", "[", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"x", ",", "y"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "xmin", ",", "xmax"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "ymin", ",", "ymax"}], "}"}], ",", 
          RowBox[{"ContourStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Thick", ",", "Gray"}], "]"}]}], ",", 
          RowBox[{"ColorFunction", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"White", "&"}], ")"}]}], ",", 
          RowBox[{"Axes", "\[Rule]", "None"}], ",", 
          RowBox[{"Ticks", "\[Rule]", "None"}], ",", 
          RowBox[{"BoundaryStyle", "\[Rule]", "None"}], ",", 
          RowBox[{"Frame", "\[Rule]", "None"}], ",", 
          RowBox[{"ContourLabels", "\[Rule]", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"z", ",", "16"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], "]"}]}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{"plt", ",", "gv", ",", 
         RowBox[{"Ticks", "\[Rule]", "None"}], ",", 
         RowBox[{"BoundaryStyle", "\[Rule]", "None"}], ",", 
         RowBox[{"Frame", "\[Rule]", "None"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pt", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"box", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], "/", "2"}], ",", 
          RowBox[{
           RowBox[{"box", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], "/", "2"}]}], "}"}], ",", 
        "\"\<(a,b)\>\""}], "}"}], ",", 
      RowBox[{"box", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", "2"}], ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"box", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", "2"}], ",", "2"}], "]"}], "]"}], ",", "Locator"}],
      "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8545769219372687`*^9, 3.854577222349042*^9}, {
  3.854577253766806*^9, 3.8545773314661875`*^9}, {3.8545773649806623`*^9, 
  3.8545773965104547`*^9}, {3.85462896965142*^9, 3.8546290393801055`*^9}, {
  3.854629105349491*^9, 3.854629230403223*^9}, {3.8546294490978837`*^9, 
  3.854629713837858*^9}, {3.854629759346128*^9, 3.8546297694503417`*^9}, {
  3.85462994236932*^9, 
  3.854629942648822*^9}},ExpressionUUID->"0715d07d-a0ce-4dc5-a867-\
67fde3fc99fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"surfgrad", "[", 
   RowBox[{"f_", ",", 
    RowBox[{"box_", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "2"}], "}"}]}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xmin", "=", 
         RowBox[{"box", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"xmax", "=", 
         RowBox[{"box", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
        RowBox[{"ymin", "=", 
         RowBox[{"box", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"ymax", "=", 
         RowBox[{"box", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", 
        RowBox[{"zmin", "=", 
         RowBox[{"box", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"zmax", "=", 
         RowBox[{"box", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ",", 
        RowBox[{"a", "=", 
         RowBox[{"pt", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"b", "=", 
         RowBox[{"pt", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", "surf", ",", "grad", ",", 
        "gv"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"grad", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"x", ",", "y"}], "]"}], ",", "x"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"x", ",", "y"}], "]"}], ",", "y"}], "]"}], ",", "0"}], 
          "}"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "\[Rule]", 
            RowBox[{"pt", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"y", "\[Rule]", 
            RowBox[{"pt", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"gv", "=", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Red", ",", "Thick", ",", 
           RowBox[{"PointSize", "[", "Large", "]"}], ",", 
           RowBox[{"Point", "[", 
            RowBox[{"{", 
             RowBox[{"a", ",", "b", ",", "0"}], "}"}], "]"}], ",", 
           RowBox[{"Point", "[", 
            RowBox[{"{", 
             RowBox[{"a", ",", "b", ",", 
              RowBox[{"f", "[", 
               RowBox[{"a", ",", "b"}], "]"}]}], "}"}], "]"}], ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"a", ",", "b", ",", "0"}], "}"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a", ",", "b", ",", "0"}], "}"}], "+", "grad"}]}], 
             "}"}], "]"}], ",", "Black", ",", "Dashed", ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"a", ",", "b", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "b", ",", 
                RowBox[{"f", "[", 
                 RowBox[{"a", ",", "b"}], "]"}]}], "}"}]}], "}"}], "]"}]}], 
          "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"surf", "=", 
        RowBox[{"Plot3D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"zmin", ",", 
            RowBox[{"f", "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "xmin", ",", "xmax"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "ymin", ",", "ymax"}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Directive", "[", 
              RowBox[{"LightGray", ",", 
               RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", 
             RowBox[{"Directive", "[", 
              RowBox[{"LightBlue", ",", 
               RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}]}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{"surf", ",", "gv", ",", 
         RowBox[{"PlotRange", "\[Rule]", "box"}], ",", 
         RowBox[{"BoxRatios", "\[Rule]", "Automatic"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pt", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"box", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], "/", "2"}], ",", 
          RowBox[{
           RowBox[{"box", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], "/", "2"}]}], "}"}], ",", 
        "\"\<(a,b)\>\""}], "}"}], ",", 
      RowBox[{"box", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", "2"}], ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"box", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", "2"}], ",", "2"}], "]"}], "]"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8546299146337185`*^9, 3.854629921036357*^9}, {
  3.854629954044773*^9, 3.854630080023856*^9}, {3.854630126583106*^9, 
  3.854630215302698*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"2c1b29e5-a33d-4cd2-b8ca-c1cd3e0b5385"],

Cell[BoxData[
 RowBox[{"contourgrad", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sin", "[", "#1", "]"}], "-", 
       RowBox[{"Cos", "[", "#2", "]"}], "+", 
       RowBox[{"0.1", "#1", " ", "#2"}]}], ")"}], "+", "3"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "6"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.854629044910079*^9, 3.8546290537584925`*^9}, {
  3.85462994578625*^9, 
  3.8546299461361427`*^9}},ExpressionUUID->"bc425d01-5a92-43fa-b97e-\
bb59f9a0e921"],

Cell[BoxData[
 RowBox[{"surfgrad", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sin", "[", "#1", "]"}], "-", 
       RowBox[{"Cos", "[", "#2", "]"}], "+", 
       RowBox[{"0.1", "#1", " ", "#2"}]}], ")"}], "+", "3"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "6"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8546299288589478`*^9, 3.854629930275457*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"0b540090-5223-46ff-a451-b1b1986c9ab0"]
},
WindowSize->{760, 841},
WindowMargins->{{Automatic, 243}, {Automatic, 55}},
FrontEndVersion->"12.2 for Microsoft Windows (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"12fe25ba-2cea-4091-9aa0-5e9f79ac1f92"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 5315, 141, 257, "Input",ExpressionUUID->"0715d07d-a0ce-4dc5-a867-67fde3fc99fa"],
Cell[5876, 163, 5820, 159, 257, "Input",ExpressionUUID->"2c1b29e5-a33d-4cd2-b8ca-c1cd3e0b5385"],
Cell[11699, 324, 636, 19, 28, "Input",ExpressionUUID->"bc425d01-5a92-43fa-b97e-bb59f9a0e921"],
Cell[12338, 345, 665, 19, 28, "Input",ExpressionUUID->"0b540090-5223-46ff-a451-b1b1986c9ab0"]
}
]
*)

